<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Index Fund vs Stock Picking Calculator &#8212; WealthDelay</title>
<meta name="description" content="See the compounded wealth difference between index fund investing and stock picking over your career.">
<link rel="canonical" href="https://wealthdelay.com/tools/tool-24.html">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YPNEP9J1LN"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-YPNEP9J1LN');</script>
<style>:root {
  --ink: #1d1d1f; --ink2: #3d3d3f; --muted: #6e6e73; --faint: #aeaeb2;
  --border: rgba(0,0,0,0.08); --border-strong: rgba(0,0,0,0.12);
  --bg: #f5f5f7; --bg2: #ebebed; --white: #ffffff;
  --green: #1db954; --green-dark: #15803d; --green-light: #f0fdf4; --green-mid: #bbf7d0;
  --red: #ff3b30; --amber: #ff9500; --blue: #0071e3; --purple: #8b5cf6;
  --font: -apple-system,BlinkMacSystemFont,"SF Pro Display","SF Pro Text","Helvetica Neue",Arial,sans-serif;
  --shadow-xs: 0 1px 2px rgba(0,0,0,.04);
  --shadow-sm: 0 2px 8px rgba(0,0,0,.06),0 1px 3px rgba(0,0,0,.04);
  --shadow: 0 8px 32px rgba(0,0,0,.08),0 2px 8px rgba(0,0,0,.04);
  --radius: 18px; --radius-sm: 12px; --radius-xs: 8px;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
html{scroll-behavior:smooth;-webkit-text-size-adjust:100%;}
body{font-family:var(--font);background:var(--bg);color:var(--ink);font-size:17px;line-height:1.52941;-webkit-font-smoothing:antialiased;}
nav{position:sticky;top:0;z-index:200;height:52px;background:rgba(245,245,247,.85);backdrop-filter:saturate(180%) blur(20px);-webkit-backdrop-filter:saturate(180%) blur(20px);border-bottom:1px solid rgba(0,0,0,.1);display:flex;align-items:center;justify-content:space-between;padding:0 22px;}
.nav-left{display:flex;align-items:center;gap:16px;}
.nav-logo{display:flex;align-items:center;gap:9px;text-decoration:none;}
.logo-text{font-size:16px;font-weight:600;letter-spacing:-.022em;line-height:1;}
.logo-text .w{color:var(--green);}.logo-text .d{color:var(--ink);}
.nav-back{font-size:13px;color:var(--blue);text-decoration:none;font-weight:500;display:flex;align-items:center;gap:4px;}
.nav-back:hover{text-decoration:underline;}
.nav-pill{font-size:12px;font-weight:500;color:var(--green);background:var(--green-light);border:1px solid var(--green-mid);padding:4px 12px;border-radius:20px;display:flex;align-items:center;gap:5px;}
.nav-pill::before{content:'';width:6px;height:6px;background:var(--green);border-radius:50%;animation:pulse 2s ease infinite;}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.5;transform:scale(.85)}}
.tool-hero{text-align:center;padding:64px 22px 52px;background:var(--white);border-bottom:1px solid var(--border);}
.tool-eyebrow{display:inline-flex;align-items:center;gap:8px;font-size:12px;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:.07em;margin-bottom:16px;}
.tool-eyebrow .cat{color:var(--green);}
.tool-h1{font-size:clamp(32px,5vw,56px);font-weight:700;letter-spacing:-.05em;line-height:1.05;color:var(--ink);max-width:720px;margin:0 auto 16px;}
.tool-h1 .red{color:var(--red);font-style:italic;}
.tool-h1 .green{color:var(--green);}
.tool-sub{font-size:clamp(16px,1.8vw,19px);color:var(--muted);max-width:520px;margin:0 auto 32px;line-height:1.6;letter-spacing:-.01em;}
.hero-badges{display:flex;align-items:center;justify-content:center;gap:8px;flex-wrap:wrap;}
.badge{font-size:13px;font-weight:500;color:var(--muted);background:var(--bg);border:1px solid var(--border);padding:6px 14px;border-radius:20px;}
.workspace{max-width:1080px;margin:0 auto;padding:32px 22px 80px;display:grid;grid-template-columns:360px 1fr;gap:20px;align-items:start;}
@media(max-width:880px){.workspace{grid-template-columns:1fr;}}
.card{background:var(--white);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden;border:1px solid var(--border);}
.card-head{padding:16px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;}
.card-title{font-size:13px;font-weight:600;color:var(--ink2);letter-spacing:-.01em;}
.live-badge{font-size:11px;font-weight:600;color:var(--green);background:var(--green-light);border:1px solid var(--green-mid);padding:3px 10px;border-radius:20px;}
.card-body{padding:20px;}
.section-label{font-size:11px;font-weight:600;color:var(--green);text-transform:uppercase;letter-spacing:.06em;margin:20px 0 12px;display:flex;align-items:center;gap:8px;}
.section-label:first-child{margin-top:0;}
.section-label::after{content:'';flex:1;height:1px;background:var(--border);}
.field{margin-bottom:16px;}.field:last-child{margin-bottom:0;}
.field-row{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
.field label{display:flex;justify-content:space-between;align-items:center;font-size:13px;font-weight:500;color:var(--ink2);margin-bottom:8px;letter-spacing:-.01em;}
.field-val{font-size:13px;font-weight:600;color:var(--ink);background:var(--bg);padding:2px 9px;border-radius:6px;min-width:60px;text-align:center;letter-spacing:-.01em;}
.field-hint{font-size:11px;color:var(--faint);margin-top:5px;line-height:1.5;}
input[type=range]{-webkit-appearance:none;width:100%;height:4px;border-radius:2px;background:var(--bg2);outline:none;cursor:pointer;}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:22px;height:22px;background:var(--white);border:none;border-radius:50%;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,.18),0 0 0 1px rgba(0,0,0,.08);transition:transform .15s,box-shadow .15s;}
input[type=range]::-webkit-slider-thumb:hover{transform:scale(1.12);box-shadow:0 4px 12px rgba(0,0,0,.22),0 0 0 1px rgba(0,0,0,.1);}
select.inp,input.inp{width:100%;background:var(--white);border:1px solid var(--border-strong);border-radius:var(--radius-xs);padding:10px 12px;color:var(--ink);font-family:var(--font);font-size:14px;font-weight:500;outline:none;letter-spacing:-.01em;}
select.inp{cursor:pointer;-webkit-appearance:none;appearance:none;padding-right:32px;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath d='M1 1l4 4 4-4' stroke='%23aeaeb2' stroke-width='1.5' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center;}
select.inp:focus,input.inp:focus{border-color:var(--green);outline:none;}
.results{display:flex;flex-direction:column;gap:14px;}
.metric-hero{background:var(--white);border-radius:var(--radius);box-shadow:var(--shadow);border:1px solid var(--border);overflow:hidden;}
.mh-top{padding:28px 24px 20px;background:linear-gradient(180deg,#fafffe 0%,#fff 100%);border-bottom:1px solid var(--border);}
.mh-eyebrow{font-size:11px;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:.07em;margin-bottom:10px;}
.mh-number{font-size:clamp(44px,7vw,60px);font-weight:700;letter-spacing:-.05em;line-height:1;margin-bottom:6px;font-variant-numeric:tabular-nums;transition:color .3s;}
.mh-number.red{color:var(--red);}.mh-number.green{color:var(--green);}.mh-number.blue{color:var(--blue);}.mh-number.amber{color:var(--amber);}
.mh-sub{font-size:14px;color:var(--muted);letter-spacing:-.01em;}
.mh-sub strong{color:var(--ink);font-weight:600;}
.mh-row{display:grid;grid-template-columns:repeat(3,1fr);}
.mh-cell{padding:16px 20px;border-right:1px solid var(--border);transition:background .15s;}
.mh-cell:last-child{border-right:none;}.mh-cell:hover{background:rgba(0,0,0,.015);}
.mh-cell.two{grid-template-columns:repeat(2,1fr);}
.mhc-label{font-size:10px;font-weight:600;color:var(--faint);text-transform:uppercase;letter-spacing:.07em;margin-bottom:5px;}
.mhc-val{font-size:22px;font-weight:700;letter-spacing:-.04em;line-height:1;margin-bottom:3px;font-variant-numeric:tabular-nums;}
.mhc-val.red{color:var(--red);}.mhc-val.amber{color:var(--amber);}.mhc-val.blue{color:var(--blue);}.mhc-val.green{color:var(--green);}.mhc-val.purple{color:var(--purple);}
.mhc-sub{font-size:11px;color:var(--faint);}
.insight{background:#fffbf0;border:1px solid #ffe4a0;border-radius:var(--radius);padding:18px 20px;display:flex;gap:14px;}
.insight-icon{font-size:20px;flex-shrink:0;margin-top:1px;}
.insight-label{font-size:11px;font-weight:600;color:var(--amber);text-transform:uppercase;letter-spacing:.07em;margin-bottom:5px;}
.insight-text{font-size:14px;color:var(--ink2);line-height:1.65;letter-spacing:-.005em;}
.insight-text strong{color:var(--ink);font-weight:600;}
.chart-card{background:var(--white);border-radius:var(--radius);box-shadow:var(--shadow);border:1px solid var(--border);overflow:hidden;}
.chart-head{padding:14px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;}
.chart-legend{display:flex;gap:16px;flex-wrap:wrap;}
.leg{display:flex;align-items:center;gap:6px;font-size:12px;color:var(--muted);font-weight:500;}
.leg-dot{width:8px;height:8px;border-radius:50%;}
.chart-inner{padding:16px 20px;}
canvas{width:100%!important;height:200px!important;display:block;}
.breakdown-card{background:var(--white);border-radius:var(--radius);box-shadow:var(--shadow);border:1px solid var(--border);overflow:hidden;}
.bd-row{display:flex;justify-content:space-between;align-items:center;padding:13px 20px;border-bottom:1px solid var(--border);gap:12px;transition:background .1s;}
.bd-row:last-child{border-bottom:none;}.bd-row:hover{background:rgba(0,0,0,.015);}
.bd-lbl{font-size:13px;color:var(--muted);letter-spacing:-.01em;}
.bd-val{font-size:13px;font-weight:600;white-space:nowrap;letter-spacing:-.02em;font-variant-numeric:tabular-nums;}
.bd-val.red{color:var(--red);}.bd-val.amber{color:var(--amber);}.bd-val.green{color:var(--green);}.bd-val.blue{color:var(--blue);}.bd-val.ink{color:var(--ink2);}.bd-val.purple{color:var(--purple);}
.compare-card{background:var(--white);border-radius:var(--radius);box-shadow:var(--shadow);border:1px solid var(--border);overflow:hidden;}
.compare-row{display:grid;grid-template-columns:160px 1fr 1fr;border-bottom:1px solid var(--border);}
.compare-row:last-child{border-bottom:none;}
.compare-row.header{background:var(--bg);}
.compare-cell{padding:12px 16px;font-size:13px;}
.compare-cell.label{color:var(--muted);font-weight:500;}
.compare-cell.a{color:var(--red);font-weight:600;font-variant-numeric:tabular-nums;}
.compare-cell.b{color:var(--green);font-weight:600;font-variant-numeric:tabular-nums;}
.compare-cell.head{font-size:11px;font-weight:700;color:var(--faint);text-transform:uppercase;letter-spacing:.06em;}
.ad-slot{background:rgba(0,0,0,.03);border:1px dashed var(--border-strong);border-radius:var(--radius-sm);display:flex;align-items:center;justify-content:center;color:var(--faint);font-size:11px;letter-spacing:.03em;text-transform:uppercase;}
.ad-rect{height:280px;width:100%;}
.faq-wrap{max-width:680px;margin:0 auto;padding:0 22px 64px;}
.section-title{font-size:clamp(22px,3vw,30px);font-weight:700;letter-spacing:-.04em;color:var(--ink);text-align:center;margin-bottom:20px;}
.faq-item{border-bottom:1px solid var(--border);}
.faq-q{display:flex;justify-content:space-between;align-items:center;padding:16px 0;font-size:15px;font-weight:500;color:var(--ink2);cursor:pointer;gap:16px;letter-spacing:-.01em;transition:color .12s;}
.faq-q:hover{color:var(--ink);}
.faq-ico{width:22px;height:22px;background:var(--bg2);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:15px;color:var(--muted);flex-shrink:0;transition:all .2s;}
.faq-ico.open{background:var(--green);color:white;transform:rotate(45deg);}
.faq-a{display:none;padding:0 0 16px;font-size:14px;color:var(--muted);line-height:1.7;letter-spacing:-.005em;}
.faq-a.open{display:block;}
.faq-a code{font-size:12px;background:var(--bg2);padding:2px 6px;border-radius:5px;color:var(--green);font-family:"SF Mono","Monaco",monospace;font-weight:500;}
footer{background:var(--bg);border-top:1px solid var(--border);padding:32px 22px;text-align:center;}
.footer-logo{font-size:15px;font-weight:600;color:var(--ink2);letter-spacing:-.02em;margin-bottom:8px;}
.footer-logo .w{color:var(--green);}
.footer-links{display:flex;justify-content:center;gap:20px;flex-wrap:wrap;margin-top:10px;}
.footer-links a{font-size:12px;color:var(--muted);text-decoration:none;}
.footer-links a:hover{color:var(--ink);}
.footer-copy{font-size:12px;color:var(--faint);margin-top:10px;}
.disclaimer{max-width:1080px;margin:0 auto;padding:0 22px 24px;font-size:12px;color:var(--faint);line-height:1.7;text-align:center;}
@keyframes fadeUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
.tool-hero{animation:fadeUp .45s ease both;}
.workspace{animation:fadeUp .45s .1s ease both;}
@media(max-width:600px){
  .tool-h1{font-size:30px;}
  .mh-number{font-size:40px;}
  .mh-row{grid-template-columns:1fr 1fr;}
  .mh-cell:nth-child(3){grid-column:1/-1;border-top:1px solid var(--border);border-right:none;}
  .field-row{grid-template-columns:1fr;}
  nav .nav-pill{display:none;}
}

.field-val { cursor: text; transition: background .15s, box-shadow .15s; }
.field-val:hover { background: var(--bg2); box-shadow: 0 0 0 1px var(--border-strong); }
.field-val-input {
  font-size: 13px; font-weight: 600; color: var(--ink);
  background: var(--white); border: 1.5px solid var(--green);
  border-radius: 6px; padding: 1px 7px; min-width: 60px; max-width: 90px;
  text-align: center; letter-spacing: -0.01em; outline: none;
  box-shadow: 0 0 0 3px rgba(29,185,84,.15); font-family: var(--font);
}
</style>
</head>
<body>
<nav>
  <div class="nav-left">
    <a class="nav-logo" href="/index.html">
      <svg width="32" height="32" viewBox="0 0 32 32" fill="none"><rect width="32" height="32" rx="8" fill="#1d1d1f"/><polyline points="5,20 9,12 13,18 17,10 21,16 27,8" stroke="#1db954" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/><line x1="5" y1="24" x2="27" y2="24" stroke="rgba(255,255,255,0.15)" stroke-width="1" stroke-linecap="round"/><circle cx="27" cy="8" r="2.5" fill="#1db954"/></svg>
      <div class="logo-text"><span class="w">Wealth</span><span class="d">Delay</span></div>
    </a>
    <a class="nav-back" href="/index.html">&#8592; All Tools</a>
  </div>
  <div class="nav-pill">Live Calculator</div>
</nav>
<section class="tool-hero">
  <div class="tool-eyebrow">Tool 24 of 30 &nbsp;&#183;&nbsp; <span class="cat">Investing</span></div>
  <h1 class="tool-h1">A 2% return gap compounds into <span class="red">hundreds of thousands.</span></h1>
  <p class="tool-sub">Enter your investment and return rates. See exactly how much the return gap compounds to over your career.</p>
  <div class="hero-badges"><div class="badge">&#128208; Verified math</div><div class="badge">&#9889; Instant results</div><div class="badge">&#128274; No data stored</div><div class="badge">$0 Free</div></div>
</section>
<div class="workspace">
  <div><div class="card"><div class="card-head"><div class="card-title">Your Parameters</div><div class="live-badge">Live</div></div><div class="card-body"><div class="section-label">Your Investment</div><div class="field"><label>Lump sum invested today <span class="field-val" id="v-lump">$10000</span></label><input type="range" id="s-lump" min="0" max="500000" step="1000" value="10000" oninput="syncSlider('lump',this.value,'$','',true,false);calc()"></div><div class="field"><label>Additional monthly contribution <span class="field-val" id="v-monthly">$300/mo</span></label><input type="range" id="s-monthly" min="0" max="5000" step="50" value="300" oninput="syncSlider('monthly',this.value,'$','/mo',false,false);calc()"></div><div class="section-label">Return Rates</div><div class="field"><label>Index fund return <span class="field-val" id="v-idx">7%</span></label><input type="range" id="s-idx" min="2" max="14" step="0.5" value="7" oninput="syncSlider('idx',this.value,'','%',false,false);calc()"><div class="field-hint">Historical S&P 500 avg</div></div><div class="field"><label>Stock picking / active fund return <span class="field-val" id="v-pick">5%</span></label><input type="range" id="s-pick" min="1" max="14" step="0.5" value="5" oninput="syncSlider('pick',this.value,'','%',false,false);calc()"><div class="field-hint">Typical active fund after fees</div></div><div class="section-label">Your Profile</div><div class="field-row"><div class="field"><label>Current age <span class="field-val" id="v-age">30</span></label><input type="range" id="s-age" min="18" max="65" step="1" value="30" oninput="syncSlider('age',this.value,'','',false,false);calc()"></div><div class="field"><label>Retire at <span class="field-val" id="v-ret">65</span></label><input type="range" id="s-ret" min="45" max="80" step="1" value="65" oninput="syncSlider('ret',this.value,'','',false,false);calc()"></div></div></div></div></div>
  <div class="results">
    <div class="metric-hero">
      <div class="mh-top">
        <div class="mh-eyebrow">Index Fund Advantage Over Stock Picking</div>
        <div class="mh-number" id="r-hero">&#8212;</div>
        <div class="mh-sub" id="r-sub">calculating&#8230;</div>
      </div>
      <div class="mh-row" id="r-metrics"></div>
    </div>
    <div class="insight"><div class="insight-icon">&#128161;</div><div><div class="insight-label">What This Really Means</div><div class="insight-text" id="r-insight">Adjust the sliders to see your personalised analysis.</div></div></div>
    <div class="chart-card"><div class="chart-head"><div class="card-title">Index vs Stock Picking</div><div class="chart-legend"><div class="leg"><div class="leg-dot" style="background:#1db954"></div>Index fund</div><div class="leg"><div class="leg-dot" style="background:#ff3b30"></div>Stock picking</div></div></div><div class="chart-inner"><canvas id="chart"></canvas></div></div>
    <div class="breakdown-card"><div class="card-head"><div class="card-title">Full Breakdown</div></div><div class="bd-row"><div class="bd-lbl">Total invested</div><div class="bd-val ink" id="r-b1">&#8212;</div></div><div class="bd-row"><div class="bd-lbl">Cash invested</div><div class="bd-val ink" id="r-b2">&#8212;</div></div><div class="bd-row"><div class="bd-lbl">Index fund value</div><div class="bd-val green" id="r-b3">&#8212;</div></div><div class="bd-row"><div class="bd-lbl">Stock picking value</div><div class="bd-val red" id="r-b4">&#8212;</div></div><div class="bd-row"><div class="bd-lbl">Index advantage</div><div class="bd-val green" id="r-b5">&#8212;</div></div><div class="bd-row"><div class="bd-lbl">% more wealth (index)</div><div class="bd-val green" id="r-b6">&#8212;</div></div></div>
    <div class="ad-slot ad-rect" style="height:120px">GOOGLE ADSENSE &#8212; Replace after approval</div>
  </div>
</div>
<section class="faq-wrap"><h2 class="section-title">Common Questions</h2><div class="faq-item"><div class="faq-q" onclick="toggleFaq(this)">Do most stock pickers beat the market?<div class="faq-ico">+</div></div><div class="faq-a">No. Over 15-year periods, roughly 90% of active fund managers underperform their benchmark index after fees, according to SPIVA data.</div></div><div class="faq-item"><div class="faq-q" onclick="toggleFaq(this)">What is the typical drag from stock picking?<div class="faq-ico">+</div></div><div class="faq-a">Active funds charge 0.5-1.5% in fees vs 0.03-0.1% for index funds. Combined with underperformance, the gap is often 1-3% annually — which compounds to massive differences over decades.</div></div></section>
<div class="disclaimer"><strong>Disclaimer:</strong> For educational purposes only. Not financial advice. Projections use historical averages and are not guaranteed. Consult a qualified financial advisor.</div>
<footer>
  <div class="footer-logo"><span class="w">Wealth</span>Delay</div>
  <div class="footer-copy">&#169; 2025 WealthDelay &#183; Free forever &#183; No data stored &#183; All calculations run in your browser</div>
  <div class="footer-links">
    <a href="/index.html">Home</a>
    <a href="/privacy.html">Privacy</a>
    <a href="/disclaimer.html">Disclaimer</a>
    <a href="/about.html">About</a>
  </div>
</footer>
<script>
// ── WealthDelay Shared Math Library ──────────────────
// All formulas verified against standard financial math

// Future Value of Annuity: periodic payments compounding
function fvAnnuity(pmt, annualRate, years) {
  const r = annualRate / 12;
  const n = years * 12;
  if (r === 0) return pmt * n;
  return pmt * ((Math.pow(1 + r, n) - 1) / r);
}

// Future Value of Lump Sum
function fvLump(pv, annualRate, years) {
  const r = annualRate / 12;
  return pv * Math.pow(1 + r, years * 12);
}

// Real (inflation-adjusted) value
function realValue(nominal, inflationRate, years) {
  return nominal / Math.pow(1 + inflationRate, years);
}

// Amortization payoff: returns {months, totalPaid, interestPaid}
function amortize(balance, annualRate, monthlyPayment) {
  const mRate = annualRate / 12;
  let b = balance, total = 0, months = 0;
  while (b > 0.01 && months < 600) {
    const interest = b * mRate;
    const principal = monthlyPayment - interest;
    if (principal <= 0) { months = 600; break; }
    b = Math.max(0, b - principal);
    total += monthlyPayment;
    months++;
  }
  return { months, totalPaid: total, interestPaid: total - balance };
}

// Drawdown: how long savings last
function drawdown(balance, annualWithdrawal, returnRate, inflationRate) {
  const mRate = returnRate / 12;
  let b = balance, months = 0;
  let mWithdrawal = annualWithdrawal / 12;
  while (b > 0 && months < 1200) {
    b = b * (1 + mRate) - mWithdrawal;
    mWithdrawal *= (1 + inflationRate / 12);
    if (b <= 0) { b = 0; break; }
    months++;
  }
  return { months, years: months / 12 };
}

// Format currency
function fmt(n) {
  if (!isFinite(n)) return '$0';
  const a = Math.abs(n);
  if (a >= 1e9) return '$' + (n / 1e9).toFixed(2) + 'B';
  if (a >= 1e6) return '$' + (n / 1e6).toFixed(2) + 'M';
  if (a >= 1e3) return '$' + (n / 1e3).toFixed(1) + 'K';
  return '$' + Math.round(n).toLocaleString();
}

function fmtFull(n) {
  return '$' + Math.round(Math.abs(n)).toLocaleString();
}

function fmtPct(n) {
  return (n * 100).toFixed(1) + '%';
}

// Sync slider display + gradient
function syncSlider(id, val, pre, suf, comma, abbrev) {
  const el = document.getElementById('v-' + id);
  if (!el) return;
  let d = val;
  if (abbrev) {
    const num = Number(val);
    d = num >= 1e6 ? (num / 1e6).toFixed(1) + 'M' : num >= 1e3 ? (num / 1e3).toFixed(0) + 'K' : num;
  } else if (comma) {
    d = Number(val).toLocaleString();
  }
  el.textContent = pre + d + suf;
  const s = document.getElementById('s-' + id);
  if (s) {
    const p = ((s.value - s.min) / (s.max - s.min)) * 100;
    s.style.background = `linear-gradient(to right,#1db954 0%,#1db954 ${p}%,#ebebed ${p}%,#ebebed 100%)`;
  }
}

function initSliders() {
  document.querySelectorAll('input[type=range]').forEach(s => {
    const p = ((s.value - s.min) / (s.max - s.min)) * 100;
    s.style.background = `linear-gradient(to right,#1db954 0%,#1db954 ${p}%,#ebebed ${p}%,#ebebed 100%)`;
  });
}

// Draw 2-line chart on canvas
function drawChart(canvasId, labels, series, colors) {
  const canvas = document.getElementById(canvasId);
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const dpr = window.devicePixelRatio || 1;
  const W = canvas.parentElement.offsetWidth, H = 200;
  canvas.width = W * dpr; canvas.height = H * dpr;
  canvas.style.width = W + 'px'; canvas.style.height = H + 'px';
  ctx.scale(dpr, dpr);
  const pad = { t: 10, r: 12, b: 28, l: 56 };
  const cW = W - pad.l - pad.r, cH = H - pad.t - pad.b;
  ctx.clearRect(0, 0, W, H);
  const allV = series.flat().filter(isFinite);
  if (!allV.length) return;
  const maxV = Math.max(...allV, 0.01), minV = Math.min(...allV, 0), range = maxV - minV || 1;
  const sx = i => pad.l + (i / (labels.length - 1 || 1)) * cW;
  const sy = v => pad.t + cH - ((v - minV) / range) * cH;
  ctx.font = `11px -apple-system,sans-serif`;
  for (let i = 0; i <= 4; i++) {
    const v = maxV - (range / 4) * i, y = sy(v);
    ctx.strokeStyle = 'rgba(0,0,0,0.06)'; ctx.lineWidth = 1;
    ctx.beginPath(); ctx.moveTo(pad.l, y); ctx.lineTo(W - pad.r, y); ctx.stroke();
    ctx.fillStyle = '#aeaeb2'; ctx.textAlign = 'right';
    ctx.fillText(fmt(v), pad.l - 4, y + 4);
  }
  ctx.fillStyle = '#aeaeb2'; ctx.textAlign = 'center';
  const step = Math.ceil(labels.length / 5);
  labels.forEach((l, i) => { if (i % step === 0 || i === labels.length - 1) ctx.fillText('' + l, sx(i), H - 4); });
  series.forEach((data, si) => {
    if (data.length < 2) return;
    const lc = colors[si] || '#1db954';
    const fc = lc + '18';
    ctx.beginPath();
    data.forEach((v, i) => i === 0 ? ctx.moveTo(sx(i), sy(v)) : ctx.lineTo(sx(i), sy(v)));
    ctx.lineTo(sx(data.length - 1), sy(Math.max(minV, 0)));
    ctx.lineTo(sx(0), sy(Math.max(minV, 0)));
    ctx.closePath(); ctx.fillStyle = fc; ctx.fill();
    ctx.beginPath();
    data.forEach((v, i) => i === 0 ? ctx.moveTo(sx(i), sy(v)) : ctx.lineTo(sx(i), sy(v)));
    ctx.strokeStyle = lc; ctx.lineWidth = 2; ctx.lineJoin = 'round'; ctx.stroke();
  });
}

function toggleFaq(el) {
  const ico = el.querySelector('.faq-ico'), ans = el.nextElementSibling, open = ans.classList.contains('open');
  document.querySelectorAll('.faq-a').forEach(a => a.classList.remove('open'));
  document.querySelectorAll('.faq-ico').forEach(i => { i.classList.remove('open'); i.textContent = '+'; });
  if (!open) { ans.classList.add('open'); ico.classList.add('open'); }
}


function calc(){
  var lump=parseFloat(document.getElementById('s-lump').value);
  var monthly=parseFloat(document.getElementById('s-monthly').value);
  var idxR=parseFloat(document.getElementById('s-idx').value)/100;
  var pickR=parseFloat(document.getElementById('s-pick').value)/100;
  var age=parseFloat(document.getElementById('s-age').value);
  var ret=parseFloat(document.getElementById('s-ret').value);
  var years=Math.max(1,ret-age);
  var fvIdx=fvLump(lump,idxR,years)+fvAnnuity(monthly,idxR,years);
  var fvPick=fvLump(lump,pickR,years)+fvAnnuity(monthly,pickR,years);
  var gap=fvIdx-fvPick;
  var cashInvested=lump+monthly*12*years;
  document.getElementById('r-hero').textContent=fmt(gap);
  document.getElementById('r-hero').style.color=gap>0?'var(--green)':'var(--red)';
  document.getElementById('r-sub').textContent='Index fund advantage over '+(pickR*100).toFixed(1)+'% stock picking \u00b7 '+years+'-year horizon';
  document.getElementById('r-metrics').innerHTML=
    '<div class="mh-cell"><div class="mhc-label">INDEX FUND</div><div class="mhc-val green">'+fmt(fvIdx)+'</div><div class="mhc-sub">'+(idxR*100).toFixed(1)+'% annual</div></div>'+
    '<div class="mh-cell"><div class="mhc-label">STOCK PICKING</div><div class="mhc-val red">'+fmt(fvPick)+'</div><div class="mhc-sub">'+(pickR*100).toFixed(1)+'% annual</div></div>'+
    '<div class="mh-cell"><div class="mhc-label">ADVANTAGE</div><div class="mhc-val green">'+fmt(gap)+'</div><div class="mhc-sub">index wins by</div></div>';
  document.getElementById('r-b1').textContent=fmtFull(lump)+' lump + $'+monthly+'/mo';
  document.getElementById('r-b2').textContent=fmtFull(cashInvested)+' total invested';
  document.getElementById('r-b3').textContent=fmt(fvIdx)+' @ '+(idxR*100).toFixed(1)+'%';
  document.getElementById('r-b4').textContent=fmt(fvPick)+' @ '+(pickR*100).toFixed(1)+'%';
  document.getElementById('r-b5').textContent=fmt(gap)+' index advantage';
  document.getElementById('r-b6').textContent=(fvPick>0?(gap/fvPick*100).toFixed(1)+'% more wealth with index':'N/A — no picking value');
  document.getElementById('r-insight').innerHTML='A <strong>'+(idxR*100-pickR*100).toFixed(1)+'% annual return gap</strong> between index investing and stock picking compounds to <strong>'+fmt(gap)+'</strong> more wealth over '+years+' years. Most active fund managers underperform the index after fees. The gap is not about skill — it is about compounding small differences over decades.';
  var cI=[],cP=[],cL=[];
  for(var y=0;y<=years;y++){cL.push(age+y);cI.push(fvLump(lump,idxR,y)+fvAnnuity(monthly,idxR,y));cP.push(fvLump(lump,pickR,y)+fvAnnuity(monthly,pickR,y));}
  drawChart('chart',cL,[cI,cP],['#1db954','#ff3b30']);
}

function makeEditable() {
  document.querySelectorAll('.field-val').forEach(function(span) {
    span.setAttribute('title','Click to type an exact value');
    span.addEventListener('click', function() {
      if (span.querySelector('input')) return;
      var raw = span.textContent.trim();
      var numeric = raw.replace(/[$,]/g,'');
      if (/[\d.]+K$/.test(numeric)) numeric = String(parseFloat(numeric)*1000);
      else if (/[\d.]+M$/.test(numeric)) numeric = String(parseFloat(numeric)*1000000);
      numeric = numeric.replace(/[^0-9.]/g,'').replace(/^\./,'0.');
      if (!numeric || isNaN(parseFloat(numeric))) numeric = '0';
      var sid = span.id ? span.id.replace('v-','s-') : null;
      var slider = sid ? document.getElementById(sid) : null;
      var inp = document.createElement('input');
      inp.type='text'; inp.inputMode='decimal'; inp.value=numeric;
      inp.className='field-val-input';
      inp.style.width=Math.max(60,numeric.length*10+20)+'px';
      span.innerHTML=''; span.appendChild(inp);
      inp.focus(); inp.select();
      function commit() {
        var v=parseFloat(inp.value.replace(/[$,%\/a-zA-Z\s]/g,'').replace(/,/g,''));
        if (isNaN(v)) v=slider?parseFloat(slider.value):0;
        if (slider) {
          var mn=parseFloat(slider.min),mx=parseFloat(slider.max),st=parseFloat(slider.step)||1;
          v=Math.min(mx,Math.max(mn,v));
          v=Math.round((v-mn)/st)*st+mn;
          v=parseFloat(v.toFixed(10));
          slider.value=v;
          slider.dispatchEvent(new Event('input',{bubbles:true}));
        }
      }
      inp.addEventListener('keydown',function(e){
        if(e.key==='Enter'){e.preventDefault();commit();inp.blur();}
        if(e.key==='Escape'){inp.blur();}
      });
      inp.addEventListener('blur',commit);
    });
  });
}

window.addEventListener('resize',function(){if(typeof calc==='function')calc();});
window.addEventListener('DOMContentLoaded',function(){initSliders();calc();makeEditable();});
</script>
</body></html>